# JavaScript 性能优化

+ 加载和执行
+ 数据存取
+ DOM编程
+ 算法和流程控制
+ 字符串和正则表达式
+ 快速响应的用户界面
+ Ajax
+ 编程实践
+ 构建并部署高性能 JavaScript 应用
+ 工具

## 加载和执行过程中的优化

> + 在 </body> 闭合标签之前，将所有的 <script> 标签放到页面底部。这能确保在脚本执行前页面已经完成了渲染。
> + 合并脚本。页面中的 <script> 标签越少，加载也就越快，响应也更迅速。无论是外链文件还是内嵌脚本。
> + 有多种无阻塞下载 JavaScript 的方法：
>
>    - 1.使用 <script> 标签的 defer 属性；
>    - 2.使用动态创建的 <script> 元素来下载并执行代码；
>    - 3.使用 XHR 对象下载 Javascript 代码并注入页面中；

## 数据存取

在 JavaScript 中，数据存储的位置会对代码整体性能产生重大的影响。数据存储共有 4 种方式：字面量、变量、数组项、对象成员。它们有着各自的性能特点。

> + 访问字面量和局部变量的速度最快，相反，访问数组元素和对象成员相对较慢。
> + 由于局部变量存在于作用域链的起始位置，因此访问局部变量比访问跨作用域变量更快。变量在作用域链中的位置越深，访问所需时间就越长。由于全局变量总处在作用域链的最末端，因此访问速度也是最慢的。
> + 避免使用 with 语句，因为它会改变执行环境作用域链。同样， try-catch 语句中的 catch 子句也有同样的影响，因此也要小心使用。
> + 嵌套的对象成员会明显影响性能，尽量少用。
> + 属性和方法在原型链中的位置越深，访问他的速度也越慢。
> + 通常来说，可以通过把常用的对象成员、数组元素、跨域变量保存在局部变量中来改善 JavaScript 性能，因为局部变量访问速度更快。

## DOM编程

访问和操作 DOM 是现代 WEB 应用的重要部分。但每次穿越连接 ECMAScript 和 DOM 两个岛屿之间的桥梁，都会被收取“过桥费“。为了减少 DOM 编程带来的性能损失，可以做到以下几点：

> + 最小化 DOM 访问次数，尽可能在 JavaScript 端处理。
> + 如果需要多次访问某个 DOM 节点，要使用局部变量存储它的引用。
> + 小心处理 HTML 集合，因为它实时联系着底层文档。把集合的长度缓存到一个变量中，并在迭代中使用它。如果需要经常操作集合，可以把它拷贝到一个数组中。
> + 使用速度更快的 API，比如 querySelectorAll（） 和 firstElementChild。
> + 留意重绘和重排，批量修改样式时，“离线”操作 DOM 树，使用缓存，并减少访问布局信息的次数。
> + 动画中使用绝对定位，使用拖放代理。
> + 使用事件委托来减少事件处理器的数量。